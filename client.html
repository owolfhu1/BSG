<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>test test</title>

    <!-- socket io -->
    <script src="/socket.io/socket.io.js"></script>
    <!-- socket io -->

    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <!-- jquery -->

    <!-- bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/darkly/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- bootstrap -->

    <style>

        .text-display{
            height: 300px;
            overflow-y: scroll;
        }

    </style>

</head>
<body>
<div class="container">
    <div class="row">

        <br/>
        <br/>

        <div id="online" style="display: none">
            <!-- text area -->
            <div class="col-sm-4">
                <!-- game data -->
                <div id="game_data" class="well text-display">
                    <!-- game data from server goes here -->
                </div>
                <!-- game data -->
                <!-- game input -->
                <input id="game_input" type="text" class="form-control" placeholder="enter game commands here"/>
                <!-- game input -->
                <br/>
                <!-- chat -->
                <div id="chat" class="well text-display">
                    <!-- chat from server goes here -->
                </div>
                <!-- chat -->
                <!-- chat input -->
                <input id="chat_input" type="text" class="form-control" placeholder="chat here"/>
                <!-- chat input -->
            </div>
            <!-- text area -->
        </div>

        <!-- body-->
        <div class="col-sm-8">
            <div id="game_body" class="well" style="height: 700px;">
                <br/>
                <br/>
                <br/>
                <br/>
                <input id="username" type="text" placeholder="username" class="form-control"/>
                <br/>
                <button id="login" class="btn btn-success btn-lg btn-block">log in</button>
            </div>
        </div>
        <!-- body -->

        <!--  -->

    </div>
</div>

<script>

    let socket = io();
    let name = 'error';
    let chat = document.getElementById('chat');
    let chat_input = document.getElementById('chat_input');
    let game_body = document.getElementById('game_body');
    let online = document.getElementById('online');
    let username = document.getElementById('username');
    let login = document.getElementById('login');
    let game_input = document.getElementById('game_input');
    let game_data = document.getElementById('game_data');
    //let something = document.getElementById('something');

    //receives chat and game_text from server and prints it in chat div
    socket.on('chat', text => {
        chat.innerHTML += text;
        chat.scrollTop = chat.scrollHeight;
    });
    socket.on('game_text', text => {
        game_data.innerHTML += text;
        game_data.scrollTop = game_data.scrollHeight;
    });

    //sends chat when enter is pressed in chat input
    chat_input.addEventListener('keyup', function(event) {
        event.preventDefault();
        if (event.keyCode === 13) {
            let text = chat_input.value;
            chat_input.value = '';
            socket.emit('chat', `${name}: ${text}</p>`);
        }
    });
    game_input.addEventListener('keyup', function(event) {
        event.preventDefault();
        if (event.keyCode === 13) {
            let text = game_input.value;
            game_input.value = '';
            socket.emit('game_text', text);
        }
    });

    //attempts to login on click
    login.addEventListener('click', () => socket.emit('login', username.value) );

    //what to do when server says login
    socket.on('login', loginName => {
        name = loginName;
        online.style.display = 'inherit';
        game_body.innerHTML = '';
    });

</script>


</body>
</html>